# SpringBoot + React Demo

Modified from [the original repo](https://github.com/eugenp/tutorials/tree/master/spring-boot-modules/spring-boot-react/src/main/java/com/baeldung/springbootreact) with SpringBoot + MyBatis + ReactJS. A detailed tutorial of the original repository can be found at [the link here](https://www.baeldung.com/spring-boot-react-crud).

## I. SpringBoot Backend (with MyBatis as ORM)

Make sure to get the dependencies as indicated in the file `pom.xml`.

1. [**Configure the database connection**]
   - Before everything, we should configure our database connection and create some table structures in our database. Here I use PostgreSQL connection as an example. In a PostgreSQL database called `demo_db`, I created a schema called `client`, under which a table with the same name `client` was created.
    ```postgresql
    drop table if exists client;
   
    create table client
    (
        id    bigint generated by default as identity
            constraint client_pk
                primary key,
        name  varchar(32) not null,
        email varchar(32) not null,
            constraint client_ck
                unique (name, email)  -- multi-column  candidate key
    );
    
    insert into client (name, email) values ('Alan', 'alanclarkson@hello.com');
    ```
   - After that, I configured the following in the `application.yml`, put under the folder `resources`.
    ```yml
    server:
      port: 8080
    spring:
      application:
        name: spring-react-demo
      datasource:
        driver-class-name: org.postgresql.Driver
        url: jdbc:postgresql://localhost:5432/demo_db
        username: postgres
        password: datagrip02
    ```
   Now the Java application can be connected to the PostgreSQL instance.
2. Structure of Content
   - main
     - java
       - com.jasonqiu.springbootreactdemo
         - controller
           - ClientController.java
         - entity
           - Client.java
         - repository
           - ClientRepository.java
         - service
           - ClientService.java
           - ClientServiceImpl.java
         - SpringbootReactDemoApplication.java
     - resources
       - application.yml
3. Intro to the five Java classes
   1. To create a Web service and connect to the database as the backend, we need to chain the following Java classes
     - (1) Controller: receives the requests from the clients.
     - (2) Service: handles the requests from the controller with the database operations defined in the repository. We create a Service interface and several implementation classes to manage the services.
     - (3) Repository: executes the database operations.
   2. (4) We have an entity class (Client.java) to bridge the Java application to the same table structure in the database.
   3. (5) We have a starter class to run the Java application.
4. Write the chain of Controller - Service - Repository
   1. `Repository`: First, we need an entity class to map to the database. After having the entity class `Client.java`, we can write our `ClientRepository.java` class and annotate the repository class with `@Mapper` (from MyBatis).
   2. `Service`: After having the repository, create an interface and one implementation class (or more) as a service. Annotate those implementations with `@Service`.
   3. `Controller`: Complete the RESTful Controller to handle client requests. Annotate with `@RestController`, as well as `@RequestMapping` before the class and every handler method.
5. Remember to add the annotations `@Autowired` to inject the fields, or use `final` fields and constructors instead for the usage of `ClientRepository` or `ClientController` in other classes.
6. Other issues
    - How to return the assigned id after insertion / update of a record?
      - Use `@Options(useGeneratedKeys = true, keyProperty = "client.id")` in the mapper / repository class
      - Use `client.getId()` after insertion / update to automatically retrieve the id in the table
    - How to generate a response
      - Use the class `ResponseEntity()`
    - Use `curl` to send HTTP requests for testing, for example
      - `curl -i -X PUT -H 'Content-Type: application/json' -d '{"id": 3, "name": "Mary", "email": "hahaha@haw.com"}' http://localhost:8080/clients/update/3`
        - and the output is
          ```
          HTTP/1.1 400 
          Content-Type: text/plain;charset=UTF-8
          Content-Length: 35
          Date: Wed, 03 Aug 2022 22:48:04 GMT
          Connection: close
    
          The record with id 3 does not exist(base)
          ```
      - `curl -i -X POST -H 'Content-Type: application/json' -d '{"name": "Alan", "email": "alanclarkson@hello.com"}' http://localhost:8080/clients/create`
          - and the output is
            ```
            HTTP/1.1 201 
            Location: /clients/2
            Content-Type: application/json
            Transfer-Encoding: chunked
            Date: Wed, 03 Aug 2022 22:51:27 GMT

            {"id":2,"name":"Alan","email":"alanclarkson@hello.com"}
            ```
7. Use the command line `mvn spring-boot:run` to start the SpringBoot Application.

## II. React Frontend



